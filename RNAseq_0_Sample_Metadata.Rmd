---
title: "RNAseq Sample Metadata"
author: "Annat Haber"
date: '`r Sys.Date()`'
output:
  html_document:
    toc: true
    code_folding: hide
    df_print: "kable"
---

```{r setup, warning=FALSE, message=FALSE}
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
knitr::opts_chunk$set(message=FALSE, warning=FALSE, cache = FALSE)
```

```{r libraries}
suppressPackageStartupMessages({
  library(tidyverse)
})
```

Sample size included in the RNAseq analysis by sex, age, and genotype.  
```{r metadata}
meta <- read_csv("data/RNAseq/RNAseq_sample_metadata.csv", col_types = cols(.default = "c")) %>%
  mutate(genotype = recode(genotype, "-/-"="TT", "-/+"="CT", "+/+"="CC"),
         group = paste(genotype, age, sex, sep="_"),
         sample_id = str_pad(tag_id, 5, pad = "0")) %>%
  arrange(sample_id)

# add treatment vector for methylKit operations
meta <- left_join(meta,
              data.frame(treatment=0:11, group=unique(meta$group)),
              by="group")

meta %>% 
  group_by(sex, age, genotype) %>%
  summarise(n=n())

saveRDS(meta, file="output/RNAseq/sample_meta.RDS")
write_csv(meta, file="output/RNAseq/RNAseq_sample_meta.csv")

```
